\hypertarget{MPU6050__GY521_8c}{}\doxysection{/media/paul/\+LINUX\+\_\+\+MEM/\+Uni/\+Git Repos/\+Body-\/\+Synthesizer\+\_\+\+STM32\+\_\+\+F746\+ZG/body-\/synthesizer-\/stm32-\/f746zg/\+Sensor\+\_\+\+Code/\+Body-\/\+Synthezier\+\_\+\+Sensors/\+Core/\+Src/\+MPU6050\+\_\+\+GY521.c File Reference}
\label{MPU6050__GY521_8c}\index{/media/paul/LINUX\_MEM/Uni/Git Repos/Body-\/Synthesizer\_STM32\_F746ZG/body-\/synthesizer-\/stm32-\/f746zg/Sensor\_Code/Body-\/Synthezier\_Sensors/Core/Src/MPU6050\_GY521.c@{/media/paul/LINUX\_MEM/Uni/Git Repos/Body-\/Synthesizer\_STM32\_F746ZG/body-\/synthesizer-\/stm32-\/f746zg/Sensor\_Code/Body-\/Synthezier\_Sensors/Core/Src/MPU6050\_GY521.c}}


software driver for MPU6050 in combination with a STM32  


{\ttfamily \#include \char`\"{}MPU6050\+\_\+\+GY521.\+h\char`\"{}}\newline
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{MPU6050__GY521_8h_a93fe4b900e9a53cf29a99adc9e64d7c4}{MPU6050\+\_\+\+STATUS}} \mbox{\hyperlink{MPU6050__GY521_8c_a1a93e7a7a1d489ec9ce063a30d1a5df5}{MPU6050\+\_\+init}} (I2\+C\+\_\+\+Handle\+Type\+Def $\ast$\+\_\+\+\_\+hi2c, \mbox{\hyperlink{structMPU6050__Data}{MPU6050\+\_\+\+Data}} $\ast$Sensor\+\_\+\+Data\+\_\+pointer, \mbox{\hyperlink{MPU6050__GY521_8h_a18ad019342a4d49779b497db4882529d}{MPU6050\+\_\+\+ACCL\+\_\+\+RES}} accl\+\_\+resolution, \mbox{\hyperlink{MPU6050__GY521_8h_aca49957b1a43f91ee978555e2dfc7ff0}{MPU6050\+\_\+\+GYRO\+\_\+\+RES}} gyro\+\_\+resolution, uint8\+\_\+t samplerate)
\begin{DoxyCompactList}\small\item\em Init for the MPU6050. \end{DoxyCompactList}\item 
\mbox{\hyperlink{MPU6050__GY521_8h_a93fe4b900e9a53cf29a99adc9e64d7c4}{MPU6050\+\_\+\+STATUS}} \mbox{\hyperlink{MPU6050__GY521_8c_a54ed50404498f4682d81ad8cb74a7150}{MPU6050\+\_\+\+Read\+\_\+\+Accl}} ()
\begin{DoxyCompactList}\small\item\em reeads only accl data \end{DoxyCompactList}\item 
\mbox{\hyperlink{MPU6050__GY521_8h_a93fe4b900e9a53cf29a99adc9e64d7c4}{MPU6050\+\_\+\+STATUS}} \mbox{\hyperlink{MPU6050__GY521_8c_ac16021f5f2c6dbf509ed77ddfc6d943d}{MPU6050\+\_\+\+Read\+\_\+\+Gyro}} ()
\begin{DoxyCompactList}\small\item\em reads only gyro data \end{DoxyCompactList}\item 
\mbox{\hyperlink{MPU6050__GY521_8h_a93fe4b900e9a53cf29a99adc9e64d7c4}{MPU6050\+\_\+\+STATUS}} \mbox{\hyperlink{MPU6050__GY521_8c_a109418b6b13fd4ddff993014f625994f}{MPU6050\+\_\+\+Read\+\_\+\+Sensor}} ()
\begin{DoxyCompactList}\small\item\em Reads raw data from accl and gyro ~\newline
 \end{DoxyCompactList}\item 
\mbox{\hyperlink{MPU6050__GY521_8h_a93fe4b900e9a53cf29a99adc9e64d7c4}{MPU6050\+\_\+\+STATUS}} \mbox{\hyperlink{MPU6050__GY521_8c_a9bffe1265ebfe68fd00af734443b6f4f}{MPU6050\+\_\+\+Calculate\+\_\+\+Mean}} ()
\begin{DoxyCompactList}\small\item\em Gets the mean value of the gyro and accl over n\+\_\+measurements. \end{DoxyCompactList}\item 
\mbox{\hyperlink{MPU6050__GY521_8h_a93fe4b900e9a53cf29a99adc9e64d7c4}{MPU6050\+\_\+\+STATUS}} \mbox{\hyperlink{MPU6050__GY521_8c_ac5545cc463f9c6b45b18aab7acc33d83}{MPU6050\+\_\+\+Calibrate}} ()
\begin{DoxyCompactList}\small\item\em Calibrates the MPU6050 and sets the offsets, which needed to be subtracted from the Rawdata to get valid information. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{MPU6050__GY521_8c_ad5e70844772059924d57cc53655aa1f2}{get\+Gyro\+Roll}} ()
\begin{DoxyCompactList}\small\item\em Get the Roll with gyro-\/data. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{MPU6050__GY521_8c_a923f606dca8c70b4e43e0191f01cd79b}{get\+Accl\+Roll}} ()
\begin{DoxyCompactList}\small\item\em Get the roll with accl-\/data ~\newline
 \end{DoxyCompactList}\item 
void \mbox{\hyperlink{MPU6050__GY521_8c_a4e9d05683d6f3a7e9cf6a2a95b4fd054}{get\+Angle\+Roll}} ()
\item 
void \mbox{\hyperlink{MPU6050__GY521_8c_ad5723da18ebbc9a3730c81df47503f5a}{MPU6050\+\_\+\+Display\+\_\+\+Data}} ()
\begin{DoxyCompactList}\small\item\em Displays all Gyro and Accl Axis. \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{MPU6050__GY521_8c_aaee8c045744fa4931cc694f7ef43d034}{MPU6050\+\_\+\+Get\+Int\+Reg}} (void)
\item 
uint8\+\_\+t \mbox{\hyperlink{MPU6050__GY521_8c_a02824d958116be29bdab36becfb8c7f6}{MPU6050\+\_\+\+Get\+DMPInt\+Reg}} (void)
\item 
uint16\+\_\+t \mbox{\hyperlink{MPU6050__GY521_8c_ad201e8f55c11cb39a7077fe1d5b32f70}{MPU6050\+\_\+\+Read\+\_\+\+FIFOcount}} (void)
\item 
void \mbox{\hyperlink{MPU6050__GY521_8c_a8885c86e21d11e448d1545147b357a6c}{MPU6050\+\_\+\+Get\+Fi\+Fo\+Data}} (uint8\+\_\+t buffer\mbox{[}1024\mbox{]})
\item 
void \mbox{\hyperlink{MPU6050__GY521_8c_a6298e3fba6912f640f4fdc1fa11fd982}{MPU6050\+\_\+\+FIFO\+\_\+\+RESET}} ()
\item 
void \mbox{\hyperlink{MPU6050__GY521_8c_ac896cd48fc6b29da35d26c89908f2481}{MPU6050\+\_\+\+Display\+\_\+\+Data\+\_\+\+DMP}} ()
\item 
\mbox{\hyperlink{group__Gyro_ga7021b2a1eb586b74239bbfa19f42724a}{tilt\+\_\+direction\+\_\+t}} \mbox{\hyperlink{MPU6050__GY521_8c_a20b3a71ff67ac6e34b54c3959891107b}{MPU6050\+\_\+detect\+Tilt}} ()
\begin{DoxyCompactList}\small\item\em detects the tilt of the Sensor in relation to the calibrated starting stance \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
software driver for MPU6050 in combination with a STM32 

\begin{DoxyAuthor}{Author}
Paul Mamatis 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
0.\+1 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
Okt 10, 2020
\end{DoxyDate}
\begin{DoxyCopyright}{Copyright}
Copyright (c) 2020 
\end{DoxyCopyright}


Definition in file \mbox{\hyperlink{MPU6050__GY521_8c_source}{MPU6050\+\_\+\+GY521.\+c}}.



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{MPU6050__GY521_8c_a923f606dca8c70b4e43e0191f01cd79b}\label{MPU6050__GY521_8c_a923f606dca8c70b4e43e0191f01cd79b}} 
\index{MPU6050\_GY521.c@{MPU6050\_GY521.c}!getAcclRoll@{getAcclRoll}}
\index{getAcclRoll@{getAcclRoll}!MPU6050\_GY521.c@{MPU6050\_GY521.c}}
\doxysubsubsection{\texorpdfstring{getAcclRoll()}{getAcclRoll()}}
{\footnotesize\ttfamily void get\+Accl\+Roll (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Get the roll with accl-\/data ~\newline
 

\begin{DoxyNote}{Note}
MPU6050\+\_\+\+Read\+\_\+\+Sensor or MPU6050\+\_\+\+Read\+\_\+\+Accl must be called before 
\end{DoxyNote}


Definition at line \mbox{\hyperlink{MPU6050__GY521_8c_source_l00366}{366}} of file \mbox{\hyperlink{MPU6050__GY521_8c_source}{MPU6050\+\_\+\+GY521.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00366                   \{}
\DoxyCodeLine{00367 }
\DoxyCodeLine{00368     \textcolor{comment}{//Parameter for stability in Regions where X and Z or Y and Z are near zero}}
\DoxyCodeLine{00369     int16\_t mu = 0.01;}
\DoxyCodeLine{00370 }
\DoxyCodeLine{00371 }
\DoxyCodeLine{00372     int16\_t X = \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Accl\_X;}
\DoxyCodeLine{00373     int16\_t Y = \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Accl\_Y;}
\DoxyCodeLine{00374     int16\_t Z = \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Accl\_Z;}
\DoxyCodeLine{00375 }
\DoxyCodeLine{00376     \textcolor{comment}{// parameter for correct orientation}}
\DoxyCodeLine{00377     int16\_t     sign;}
\DoxyCodeLine{00378     \textcolor{keywordflow}{if} (Z>0)    sign = 1;}
\DoxyCodeLine{00379     \textcolor{keywordflow}{else}        sign = -\/1;}
\DoxyCodeLine{00380 }
\DoxyCodeLine{00381     \textcolor{comment}{//transform radians to degree}}
\DoxyCodeLine{00382     \textcolor{keywordtype}{float} RAD\_TO\_DEG = 180/M\_PI;}
\DoxyCodeLine{00383 }
\DoxyCodeLine{00384     \textcolor{comment}{// Get Roll}}
\DoxyCodeLine{00385     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Ax\_deg = atan2( Y ,   sign * sqrt(Z*Z+ mu*X*X)) * RAD\_TO\_DEG;}
\DoxyCodeLine{00386     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Ay\_deg = atan2(-\/X, sqrt(Y*Y + Z*Z)) * RAD\_TO\_DEG;}
\DoxyCodeLine{00387 }
\DoxyCodeLine{00388 \}}

\end{DoxyCode}
\mbox{\Hypertarget{MPU6050__GY521_8c_a4e9d05683d6f3a7e9cf6a2a95b4fd054}\label{MPU6050__GY521_8c_a4e9d05683d6f3a7e9cf6a2a95b4fd054}} 
\index{MPU6050\_GY521.c@{MPU6050\_GY521.c}!getAngleRoll@{getAngleRoll}}
\index{getAngleRoll@{getAngleRoll}!MPU6050\_GY521.c@{MPU6050\_GY521.c}}
\doxysubsubsection{\texorpdfstring{getAngleRoll()}{getAngleRoll()}}
{\footnotesize\ttfamily void get\+Angle\+Roll (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{MPU6050__GY521_8c_source_l00394}{394}} of file \mbox{\hyperlink{MPU6050__GY521_8c_source}{MPU6050\+\_\+\+GY521.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00394                    \{}
\DoxyCodeLine{00395 }
\DoxyCodeLine{00396 \textcolor{comment}{//  MPU6050\_Read\_Sensor(Sensor\_Data);}}
\DoxyCodeLine{00397     \mbox{\hyperlink{MPU6050__GY521_8c_a923f606dca8c70b4e43e0191f01cd79b}{getAcclRoll}}(\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}});}
\DoxyCodeLine{00398     \mbox{\hyperlink{MPU6050__GY521_8c_ad5e70844772059924d57cc53655aa1f2}{getGyroRoll}}(\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}});}
\DoxyCodeLine{00399 }
\DoxyCodeLine{00400     \textcolor{keywordtype}{float} X = \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> X\_deg;}
\DoxyCodeLine{00401     \textcolor{keywordtype}{float} Y = \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Y\_deg;}
\DoxyCodeLine{00402     \textcolor{comment}{//komplementÃ¤r FIlter}}
\DoxyCodeLine{00403     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> X\_deg =  0.98 * (X + \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gx\_deg) + (0.02 * (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Ax\_deg));}
\DoxyCodeLine{00404     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Y\_deg =  0.98 * (Y + \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gy\_deg) + (0.02 * (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Ay\_deg)); }
\DoxyCodeLine{00405     \textcolor{keywordtype}{float} X = \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> X\_deg;}
\DoxyCodeLine{00406     \textcolor{keywordtype}{float} Y = \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Y\_deg;-\/> Gy\_deg) + (0.02 * (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Ay\_deg));}
\DoxyCodeLine{00407     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Z\_deg = \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Z\_deg + \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gz\_deg;}
\DoxyCodeLine{00408 \}}

\end{DoxyCode}
\mbox{\Hypertarget{MPU6050__GY521_8c_ad5e70844772059924d57cc53655aa1f2}\label{MPU6050__GY521_8c_ad5e70844772059924d57cc53655aa1f2}} 
\index{MPU6050\_GY521.c@{MPU6050\_GY521.c}!getGyroRoll@{getGyroRoll}}
\index{getGyroRoll@{getGyroRoll}!MPU6050\_GY521.c@{MPU6050\_GY521.c}}
\doxysubsubsection{\texorpdfstring{getGyroRoll()}{getGyroRoll()}}
{\footnotesize\ttfamily void get\+Gyro\+Roll (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Get the Roll with gyro-\/data. 

\begin{DoxyNote}{Note}
MPU6050\+\_\+\+Read\+\_\+\+Sensor or MPU6050\+\_\+\+Read\+\_\+\+Gyro must be called before 
\end{DoxyNote}


Definition at line \mbox{\hyperlink{MPU6050__GY521_8c_source_l00340}{340}} of file \mbox{\hyperlink{MPU6050__GY521_8c_source}{MPU6050\+\_\+\+GY521.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00340                   \{}
\DoxyCodeLine{00341 }
\DoxyCodeLine{00342     \textcolor{comment}{// time of measurement for integration}}
\DoxyCodeLine{00343     \textcolor{keywordtype}{float} cycletime = 80000000;}
\DoxyCodeLine{00344 }
\DoxyCodeLine{00345     \textcolor{comment}{// Get Roll}}
\DoxyCodeLine{00346     \textcolor{comment}{// RAW Gyrodata: Gyro\_X; transformation to Deg/s: Gyro\_mult; time since last measurement: Gyro\_time; cycletime per second: cycletime}}
\DoxyCodeLine{00347     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gx\_deg =  (float)( ((\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gyro\_X) * \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gyro\_mult ) * (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gyro\_time)) / cycletime;}
\DoxyCodeLine{00348     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gy\_deg =  (float)( ((\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gyro\_Y) * \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gyro\_mult ) * (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gyro\_time)) / cycletime;}
\DoxyCodeLine{00349     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gz\_deg =  (float)( ((\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gyro\_Z) * \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gyro\_mult ) * (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gyro\_time)) / cycletime;}
\DoxyCodeLine{00350 }
\DoxyCodeLine{00351     \textcolor{comment}{// Take into account that +-\/360 degrees is the same as 0 degrees}}
\DoxyCodeLine{00352     \textcolor{keywordflow}{if} (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gx\_deg >=180) \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gx\_deg = \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gx\_deg -\/ 360;}
\DoxyCodeLine{00353     \textcolor{keywordflow}{if} (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gx\_deg <=-\/180) \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gx\_deg = \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gx\_deg + 360;}
\DoxyCodeLine{00354 }
\DoxyCodeLine{00355     \textcolor{keywordflow}{if} (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gy\_deg >=180) \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gy\_deg = \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gy\_deg -\/ 360;}
\DoxyCodeLine{00356     \textcolor{keywordflow}{if} (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gy\_deg <=-\/180) \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gy\_deg = \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gy\_deg + 360;}
\DoxyCodeLine{00357 }
\DoxyCodeLine{00358     \textcolor{keywordflow}{if} (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gy\_deg >=180) \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gz\_deg = \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gz\_deg -\/ 360;}
\DoxyCodeLine{00359     \textcolor{keywordflow}{if} (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gy\_deg <=-\/180) \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gz\_deg = \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gz\_deg + 360;}
\DoxyCodeLine{00360 \}}

\end{DoxyCode}
\mbox{\Hypertarget{MPU6050__GY521_8c_a9bffe1265ebfe68fd00af734443b6f4f}\label{MPU6050__GY521_8c_a9bffe1265ebfe68fd00af734443b6f4f}} 
\index{MPU6050\_GY521.c@{MPU6050\_GY521.c}!MPU6050\_Calculate\_Mean@{MPU6050\_Calculate\_Mean}}
\index{MPU6050\_Calculate\_Mean@{MPU6050\_Calculate\_Mean}!MPU6050\_GY521.c@{MPU6050\_GY521.c}}
\doxysubsubsection{\texorpdfstring{MPU6050\_Calculate\_Mean()}{MPU6050\_Calculate\_Mean()}}
{\footnotesize\ttfamily \mbox{\hyperlink{MPU6050__GY521_8h_a93fe4b900e9a53cf29a99adc9e64d7c4}{MPU6050\+\_\+\+STATUS}} MPU6050\+\_\+\+Calculate\+\_\+\+Mean (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Gets the mean value of the gyro and accl over n\+\_\+measurements. 

\begin{DoxyNote}{Note}
this function is in first order a helper function for the calibration process
\end{DoxyNote}
\begin{DoxyReturn}{Returns}
MPU6050\+\_\+\+STATUS 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{MPU6050__GY521_8c_source_l00228}{228}} of file \mbox{\hyperlink{MPU6050__GY521_8c_source}{MPU6050\+\_\+\+GY521.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00228                                        \{}
\DoxyCodeLine{00229     \textcolor{comment}{// Temp memory to sum up values for mean calculation}}
\DoxyCodeLine{00230     \textcolor{comment}{// Gyroscope}}
\DoxyCodeLine{00231     int32\_t Gx\_mean\_tempbuffer  =   0;}
\DoxyCodeLine{00232     int32\_t Gy\_mean\_tempbuffer  =   0;}
\DoxyCodeLine{00233     int32\_t Gz\_mean\_tempbuffer  =   0;}
\DoxyCodeLine{00234     \textcolor{comment}{// Accelerometer}}
\DoxyCodeLine{00235     int32\_t Ax\_mean\_tempbuffer  =   0;}
\DoxyCodeLine{00236     int32\_t Ay\_mean\_tempbuffer  =   0;}
\DoxyCodeLine{00237     int32\_t Az\_mean\_tempbuffer  =   0;}
\DoxyCodeLine{00238 }
\DoxyCodeLine{00239     \textcolor{comment}{// First measurements have to be skipped}}
\DoxyCodeLine{00240     \textcolor{keywordtype}{int} n\_skipping      =   100;}
\DoxyCodeLine{00241     \textcolor{keywordtype}{int} n\_measurements  =   500;}
\DoxyCodeLine{00242     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=n\_skipping; i < n\_measurements + n\_skipping; i++)\{}
\DoxyCodeLine{00243         }
\DoxyCodeLine{00244     \textcolor{comment}{// Read Data}}
\DoxyCodeLine{00245         \textcolor{comment}{// from Gyroscope}}
\DoxyCodeLine{00246         \textcolor{keywordflow}{if} (\mbox{\hyperlink{MPU6050__GY521_8c_a109418b6b13fd4ddff993014f625994f}{MPU6050\_Read\_Sensor}}(\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}) != MPU6050\_Read\_OK)\{}
\DoxyCodeLine{00247             \textcolor{keywordflow}{return} MPU6050\_Status\_Error;}
\DoxyCodeLine{00248         \}}
\DoxyCodeLine{00249         int16\_t Gx = \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/>  Gyro\_X;}
\DoxyCodeLine{00250         int16\_t Gy = \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/>  Gyro\_Y;}
\DoxyCodeLine{00251         int16\_t Gz = \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/>  Gyro\_Z;}
\DoxyCodeLine{00252         \textcolor{comment}{// from Accelerometer}}
\DoxyCodeLine{00253         \textcolor{keywordflow}{if} (\mbox{\hyperlink{MPU6050__GY521_8c_a54ed50404498f4682d81ad8cb74a7150}{MPU6050\_Read\_Accl}}(\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}) != MPU6050\_Read\_OK)\{}
\DoxyCodeLine{00254             \textcolor{keywordflow}{return} MPU6050\_Status\_Error;}
\DoxyCodeLine{00255         \}}
\DoxyCodeLine{00256 }
\DoxyCodeLine{00257         int16\_t Ax = \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/>  Accl\_X;}
\DoxyCodeLine{00258         int16\_t Ay = \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/>  Accl\_Y;}
\DoxyCodeLine{00259         int16\_t Az = \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/>  Accl\_Z;}
\DoxyCodeLine{00260         \textcolor{comment}{// sum it up}}
\DoxyCodeLine{00261         Gx\_mean\_tempbuffer  +=  Gx;}
\DoxyCodeLine{00262         Gy\_mean\_tempbuffer  +=  Gy;}
\DoxyCodeLine{00263         Gz\_mean\_tempbuffer  +=  Gz;}
\DoxyCodeLine{00264         Ax\_mean\_tempbuffer  +=  Ax;}
\DoxyCodeLine{00265         Ay\_mean\_tempbuffer  +=  Ay;}
\DoxyCodeLine{00266         Az\_mean\_tempbuffer  +=  Az;}
\DoxyCodeLine{00267         \textcolor{comment}{// Wait to prevent double measurements}}
\DoxyCodeLine{00268         HAL\_Delay(2);}
\DoxyCodeLine{00269     \}}
\DoxyCodeLine{00270 }
\DoxyCodeLine{00271     \textcolor{comment}{//Save offset to Sensor\_Data}}
\DoxyCodeLine{00272     \textcolor{comment}{//Gyroscope offset}}
\DoxyCodeLine{00273     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Gx\_mean=Gx\_mean\_tempbuffer/n\_measurements;}
\DoxyCodeLine{00274     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Gy\_mean=Gy\_mean\_tempbuffer/n\_measurements;}
\DoxyCodeLine{00275     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Gz\_mean=Gz\_mean\_tempbuffer/n\_measurements;}
\DoxyCodeLine{00276     \textcolor{comment}{//Accelerometer offset}}
\DoxyCodeLine{00277     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Ax\_mean=Ax\_mean\_tempbuffer/n\_measurements;}
\DoxyCodeLine{00278     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Ay\_mean=Ay\_mean\_tempbuffer/n\_measurements;}
\DoxyCodeLine{00279     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Az\_mean=Az\_mean\_tempbuffer/n\_measurements;}
\DoxyCodeLine{00280 }
\DoxyCodeLine{00281     \textcolor{keywordflow}{return} MPU6050\_Read\_OK;}
\DoxyCodeLine{00282 \}}

\end{DoxyCode}
\mbox{\Hypertarget{MPU6050__GY521_8c_ac5545cc463f9c6b45b18aab7acc33d83}\label{MPU6050__GY521_8c_ac5545cc463f9c6b45b18aab7acc33d83}} 
\index{MPU6050\_GY521.c@{MPU6050\_GY521.c}!MPU6050\_Calibrate@{MPU6050\_Calibrate}}
\index{MPU6050\_Calibrate@{MPU6050\_Calibrate}!MPU6050\_GY521.c@{MPU6050\_GY521.c}}
\doxysubsubsection{\texorpdfstring{MPU6050\_Calibrate()}{MPU6050\_Calibrate()}}
{\footnotesize\ttfamily \mbox{\hyperlink{MPU6050__GY521_8h_a93fe4b900e9a53cf29a99adc9e64d7c4}{MPU6050\+\_\+\+STATUS}} MPU6050\+\_\+\+Calibrate (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Calibrates the MPU6050 and sets the offsets, which needed to be subtracted from the Rawdata to get valid information. 

\begin{DoxyReturn}{Returns}
MPU6050\+\_\+\+STATUS 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{MPU6050__GY521_8c_source_l00288}{288}} of file \mbox{\hyperlink{MPU6050__GY521_8c_source}{MPU6050\+\_\+\+GY521.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00288                                   \{}
\DoxyCodeLine{00289 }
\DoxyCodeLine{00290     \textcolor{comment}{// gravitational constant depending on accelerometer resolution}}
\DoxyCodeLine{00291     int16\_t gravitation = (int16\_t)((\textcolor{keywordtype}{float})1 / \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Accl\_mult);}
\DoxyCodeLine{00292     \textcolor{comment}{// allowed deviation from mean for raw data from sensors}}
\DoxyCodeLine{00293     int8\_t  gyro\_tolerance  = 1;}
\DoxyCodeLine{00294     int8\_t  accl\_tolerance  = 5;}
\DoxyCodeLine{00295 }
\DoxyCodeLine{00296     \textcolor{comment}{// Set offset Initially (offset is subtracted from future measurements)}}
\DoxyCodeLine{00297     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gx\_offset     =   \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gx\_mean;}
\DoxyCodeLine{00298     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gy\_offset     =   \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gy\_mean;}
\DoxyCodeLine{00299     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gz\_offset     =   \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gz\_mean;}
\DoxyCodeLine{00300     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Ax\_offset     =   \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Ax\_mean;}
\DoxyCodeLine{00301     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Ay\_offset     =   \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Ay\_mean;}
\DoxyCodeLine{00302     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Az\_offset     =   (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Az\_mean) + gravitation;}
\DoxyCodeLine{00303 }
\DoxyCodeLine{00304     \textcolor{comment}{// Indicator for correct calibration of all axis}}
\DoxyCodeLine{00305     \textcolor{keywordtype}{int} calibrated = 0;}
\DoxyCodeLine{00306     \textcolor{keywordflow}{while}(calibrated <= 6)\{}
\DoxyCodeLine{00307         printf(\textcolor{stringliteral}{"{}\%i\(\backslash\)n\(\backslash\)r"{}},calibrated );}
\DoxyCodeLine{00308         \textcolor{comment}{// Calculate means of sensors}}
\DoxyCodeLine{00309         \textcolor{keywordflow}{if} (\mbox{\hyperlink{MPU6050__GY521_8c_a9bffe1265ebfe68fd00af734443b6f4f}{MPU6050\_Calculate\_Mean}}(\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}})!= MPU6050\_Read\_OK)\{}
\DoxyCodeLine{00310             \textcolor{keywordflow}{return} MPU6050\_Status\_Error;}
\DoxyCodeLine{00311         \}}
\DoxyCodeLine{00312         \textcolor{comment}{// Validate or Update Calibration}}
\DoxyCodeLine{00313         \textcolor{comment}{// Gyroscope X Y Z}}
\DoxyCodeLine{00314         \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gx\_mean)<gyro\_tolerance) calibrated++;}
\DoxyCodeLine{00315         \textcolor{keywordflow}{else} \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gx\_offset        =   (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gx\_offset)   +   (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gx\_mean);}
\DoxyCodeLine{00316 }
\DoxyCodeLine{00317         \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gy\_mean)<gyro\_tolerance) calibrated++;}
\DoxyCodeLine{00318         \textcolor{keywordflow}{else} \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gy\_offset        =   (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gy\_offset)   +   (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gy\_mean);}
\DoxyCodeLine{00319 }
\DoxyCodeLine{00320         \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gz\_mean)<gyro\_tolerance) calibrated++;}
\DoxyCodeLine{00321         \textcolor{keywordflow}{else} \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gz\_offset        =   (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gz\_offset)   +   (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Gz\_mean);}
\DoxyCodeLine{00322         \textcolor{comment}{// Accelerometer X Y Z}}
\DoxyCodeLine{00323         \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Ax\_mean)<accl\_tolerance) calibrated++;}
\DoxyCodeLine{00324         \textcolor{keywordflow}{else} \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Ax\_offset        =   (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Ax\_offset)   +   (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Ax\_mean);}
\DoxyCodeLine{00325 }
\DoxyCodeLine{00326         \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Ay\_mean)<accl\_tolerance) calibrated++;}
\DoxyCodeLine{00327         \textcolor{keywordflow}{else} \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Ay\_offset        =   (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Ay\_offset)   +   (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Ay\_mean);}
\DoxyCodeLine{00328 }
\DoxyCodeLine{00329         \textcolor{keywordflow}{if} ((abs((\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Az\_mean) -\/ gravitation)) <accl\_tolerance) calibrated++;}
\DoxyCodeLine{00330         \textcolor{keywordflow}{else} \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Az\_offset        =   (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Az\_offset)   +   ((\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} -\/> Az\_mean) -\/ gravitation);}
\DoxyCodeLine{00331 }
\DoxyCodeLine{00332     \}}
\DoxyCodeLine{00333     \textcolor{keywordflow}{return} MPU6050\_Read\_OK;}
\DoxyCodeLine{00334 \}}

\end{DoxyCode}
\mbox{\Hypertarget{MPU6050__GY521_8c_a20b3a71ff67ac6e34b54c3959891107b}\label{MPU6050__GY521_8c_a20b3a71ff67ac6e34b54c3959891107b}} 
\index{MPU6050\_GY521.c@{MPU6050\_GY521.c}!MPU6050\_detectTilt@{MPU6050\_detectTilt}}
\index{MPU6050\_detectTilt@{MPU6050\_detectTilt}!MPU6050\_GY521.c@{MPU6050\_GY521.c}}
\doxysubsubsection{\texorpdfstring{MPU6050\_detectTilt()}{MPU6050\_detectTilt()}}
{\footnotesize\ttfamily \mbox{\hyperlink{group__Gyro_ga7021b2a1eb586b74239bbfa19f42724a}{tilt\+\_\+direction\+\_\+t}} MPU6050\+\_\+detect\+Tilt (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



detects the tilt of the Sensor in relation to the calibrated starting stance 

\begin{DoxyReturn}{Returns}
tilt\+\_\+direction\+\_\+t 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{MPU6050__GY521_8c_source_l00499}{499}} of file \mbox{\hyperlink{MPU6050__GY521_8c_source}{MPU6050\+\_\+\+GY521.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00499                                      \{}
\DoxyCodeLine{00500     \textcolor{comment}{//tilt Thresholds, right, left , front}}
\DoxyCodeLine{00501     int16\_t tilt\_TH\_X\_r,tilt\_TH\_X\_l,  tilt\_TH\_Y, tilt\_TH\_Y\_f,tilt\_TH\_Y\_b, tilt\_TH\_Z;}
\DoxyCodeLine{00502     int16\_t tilt\_TH\_X\_r\_s, tilt\_TH\_X\_l\_s,  tilt\_TH\_Y\_f\_s, tilt\_TH\_Y\_b\_s;}
\DoxyCodeLine{00503     \textcolor{comment}{//slow tilt}}
\DoxyCodeLine{00504     tilt\_TH\_X\_r = -\/1500;}
\DoxyCodeLine{00505     tilt\_TH\_X\_l = 1500;}
\DoxyCodeLine{00506     tilt\_TH\_Y   = 1500;}
\DoxyCodeLine{00507     tilt\_TH\_Y\_f = -\/1500;}
\DoxyCodeLine{00508     tilt\_TH\_Y\_b = 1500;}
\DoxyCodeLine{00509     tilt\_TH\_Z   = 3800;}
\DoxyCodeLine{00510     \textcolor{keywordtype}{float} angle\_TH = 25.0;}
\DoxyCodeLine{00511     \textcolor{comment}{//strong tilt}}
\DoxyCodeLine{00512     tilt\_TH\_X\_r\_s = -\/2500;}
\DoxyCodeLine{00513     tilt\_TH\_X\_l\_s = 2500;}
\DoxyCodeLine{00514     tilt\_TH\_Y\_f\_s = -\/3000;}
\DoxyCodeLine{00515     tilt\_TH\_Y\_b\_s = 3000;}
\DoxyCodeLine{00516 }
\DoxyCodeLine{00517     getAngleRoll(\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}});}
\DoxyCodeLine{00518     \textcolor{keywordtype}{float} alpha = sqrtf(\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>X\_deg*\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>X\_deg + \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Y\_deg* \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Y\_deg);}
\DoxyCodeLine{00519     \textcolor{comment}{//detect tilt in any diretion}}
\DoxyCodeLine{00520     \textcolor{keywordflow}{if} ((alpha > angle\_TH) \&\&  (abs(\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Accl\_Z) < tilt\_TH\_Z))\{}
\DoxyCodeLine{00521         \textcolor{comment}{//speciify direction}}
\DoxyCodeLine{00522         \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Accl\_Y) < tilt\_TH\_Y)\{}
\DoxyCodeLine{00523             \textcolor{comment}{//tilt rigth when Accl\_X is negative}}
\DoxyCodeLine{00524             \textcolor{keywordflow}{if} (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Accl\_X < tilt\_TH\_X\_r)\{}
\DoxyCodeLine{00525                 \textcolor{comment}{//}}
\DoxyCodeLine{00526                 \textcolor{keywordflow}{if} (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Accl\_X < tilt\_TH\_X\_r\_s)\{}
\DoxyCodeLine{00527                     \textcolor{comment}{//printf("{}tilt strong right \(\backslash\)r\(\backslash\)n"{});}}
\DoxyCodeLine{00528                     \textcolor{keywordflow}{return} TILT\_RIGHT\_S;}
\DoxyCodeLine{00529                 \}}
\DoxyCodeLine{00530                 \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00531                     \textcolor{comment}{//printf("{}tilt right \(\backslash\)r\(\backslash\)n"{});}}
\DoxyCodeLine{00532                     \textcolor{keywordflow}{return} TILT\_RIGHT;}
\DoxyCodeLine{00533                 \}}
\DoxyCodeLine{00534 }
\DoxyCodeLine{00535             \}}
\DoxyCodeLine{00536             \textcolor{comment}{//tilt left when Accl\_X is positiv}}
\DoxyCodeLine{00537             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Accl\_X > tilt\_TH\_X\_l) \&\& abs(\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Accl\_Y))\{}
\DoxyCodeLine{00538 }
\DoxyCodeLine{00539                 \textcolor{keywordflow}{if} (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Accl\_X > tilt\_TH\_X\_l\_s)\{}
\DoxyCodeLine{00540                                         \textcolor{comment}{//printf("{}tilt strong left\(\backslash\)r\(\backslash\)n"{});}}
\DoxyCodeLine{00541                     \textcolor{keywordflow}{return} TILT\_LEFT\_S;}
\DoxyCodeLine{00542                 \}}
\DoxyCodeLine{00543                 \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00544                                         \textcolor{comment}{//printf("{}tilt left\(\backslash\)r\(\backslash\)n"{});}}
\DoxyCodeLine{00545                     \textcolor{keywordflow}{return} TILT\_LEFT;}
\DoxyCodeLine{00546                 \}}
\DoxyCodeLine{00547             \}}
\DoxyCodeLine{00548         \}}
\DoxyCodeLine{00549         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Accl\_Y < tilt\_TH\_Y\_f)\{}
\DoxyCodeLine{00550             \textcolor{keywordflow}{if} (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Accl\_Y < tilt\_TH\_Y\_f\_s)\{}
\DoxyCodeLine{00551                                 \textcolor{comment}{//printf("{}tilt strong front\(\backslash\)r\(\backslash\)n"{});}}
\DoxyCodeLine{00552                 \textcolor{keywordflow}{return} TILT\_FRONT\_S;}
\DoxyCodeLine{00553             \}}
\DoxyCodeLine{00554             \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{00555                                 \textcolor{comment}{//printf("{}tilt front\(\backslash\)r\(\backslash\)n"{});}}
\DoxyCodeLine{00556                 \textcolor{keywordflow}{return} TILT\_FRONT;}
\DoxyCodeLine{00557             \}}
\DoxyCodeLine{00558 }
\DoxyCodeLine{00559         \}}
\DoxyCodeLine{00560         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Accl\_Y > tilt\_TH\_Y\_b)\{}
\DoxyCodeLine{00561             \textcolor{keywordflow}{if} (\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Accl\_Y > tilt\_TH\_Y\_b\_s)\{}
\DoxyCodeLine{00562                                 \textcolor{comment}{//printf("{}tilt strong back\(\backslash\)r\(\backslash\)n"{});}}
\DoxyCodeLine{00563                 \textcolor{keywordflow}{return} TILT\_BACK\_S;}
\DoxyCodeLine{00564             \}}
\DoxyCodeLine{00565             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00566                                 \textcolor{comment}{//printf("{}tilt back\(\backslash\)r\(\backslash\)n"{});}}
\DoxyCodeLine{00567                 \textcolor{keywordflow}{return} TILT\_BACK;}
\DoxyCodeLine{00568             \}}
\DoxyCodeLine{00569 }
\DoxyCodeLine{00570         \}}
\DoxyCodeLine{00571     \}}
\DoxyCodeLine{00572     \textcolor{keywordflow}{return} TILT\_NONE;}
\DoxyCodeLine{00573 \}}

\end{DoxyCode}
\mbox{\Hypertarget{MPU6050__GY521_8c_ad5723da18ebbc9a3730c81df47503f5a}\label{MPU6050__GY521_8c_ad5723da18ebbc9a3730c81df47503f5a}} 
\index{MPU6050\_GY521.c@{MPU6050\_GY521.c}!MPU6050\_Display\_Data@{MPU6050\_Display\_Data}}
\index{MPU6050\_Display\_Data@{MPU6050\_Display\_Data}!MPU6050\_GY521.c@{MPU6050\_GY521.c}}
\doxysubsubsection{\texorpdfstring{MPU6050\_Display\_Data()}{MPU6050\_Display\_Data()}}
{\footnotesize\ttfamily void MPU6050\+\_\+\+Display\+\_\+\+Data (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Displays all Gyro and Accl Axis. 



Definition at line \mbox{\hyperlink{MPU6050__GY521_8c_source_l00414}{414}} of file \mbox{\hyperlink{MPU6050__GY521_8c_source}{MPU6050\+\_\+\+GY521.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00414                            \{}
\DoxyCodeLine{00415     \textcolor{comment}{//  uint8\_t buffer[1024];}}
\DoxyCodeLine{00416     \mbox{\hyperlink{MPU6050__GY521_8c_a109418b6b13fd4ddff993014f625994f}{MPU6050\_Read\_Sensor}}(\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}});}
\DoxyCodeLine{00417     printf(\textcolor{stringliteral}{"{}Gx: \%i\(\backslash\)r\(\backslash\)n"{}}, \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Gyro\_X);\textcolor{comment}{//+(buffer[5]<<8)+(buffer[6]<<16)+(buffer[7]<<24));}}
\DoxyCodeLine{00418     printf(\textcolor{stringliteral}{"{}Gy: \%i\(\backslash\)r\(\backslash\)n"{}}, \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Gyro\_Y);}
\DoxyCodeLine{00419     printf(\textcolor{stringliteral}{"{}Gz: \%i\(\backslash\)r\(\backslash\)n"{}}, \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Gyro\_Z);}
\DoxyCodeLine{00420     printf(\textcolor{stringliteral}{"{}Ax: \%i\(\backslash\)r\(\backslash\)n"{}}, \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Accl\_X);}
\DoxyCodeLine{00421     printf(\textcolor{stringliteral}{"{}Ay: \%i\(\backslash\)r\(\backslash\)n"{}}, \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Accl\_Y);}
\DoxyCodeLine{00422     printf(\textcolor{stringliteral}{"{}Az: \%i\(\backslash\)r\(\backslash\)n"{}}, \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Accl\_Z);}
\DoxyCodeLine{00423 }
\DoxyCodeLine{00424     \textcolor{comment}{//  printf("{}Gx: \%i      **Gy: \%i        **Gz: \%i\(\backslash\)r\(\backslash\)n"{},Sensor\_Data-\/>Gyro\_X ,Sensor\_Data-\/>Gyro\_Y ,Sensor\_Data-\/>Gyro\_Z);}}
\DoxyCodeLine{00425     \textcolor{comment}{//  printf("{}Ax: \%i      **Ay: \%i        **Az: \%i\(\backslash\)r\(\backslash\)n"{}, Sensor\_Data-\/>Accl\_X,Sensor\_Data-\/>Accl\_Y, Sensor\_Data-\/>Accl\_Z);}}
\DoxyCodeLine{00426 \}}

\end{DoxyCode}
\mbox{\Hypertarget{MPU6050__GY521_8c_ac896cd48fc6b29da35d26c89908f2481}\label{MPU6050__GY521_8c_ac896cd48fc6b29da35d26c89908f2481}} 
\index{MPU6050\_GY521.c@{MPU6050\_GY521.c}!MPU6050\_Display\_Data\_DMP@{MPU6050\_Display\_Data\_DMP}}
\index{MPU6050\_Display\_Data\_DMP@{MPU6050\_Display\_Data\_DMP}!MPU6050\_GY521.c@{MPU6050\_GY521.c}}
\doxysubsubsection{\texorpdfstring{MPU6050\_Display\_Data\_DMP()}{MPU6050\_Display\_Data\_DMP()}}
{\footnotesize\ttfamily void MPU6050\+\_\+\+Display\+\_\+\+Data\+\_\+\+DMP (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{MPU6050__GY521_8c_source_l00478}{478}} of file \mbox{\hyperlink{MPU6050__GY521_8c_source}{MPU6050\+\_\+\+GY521.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00478                                \{}
\DoxyCodeLine{00479     uint8\_t buffer[1024];}
\DoxyCodeLine{00480     \mbox{\hyperlink{MPU6050__GY521_8c_a8885c86e21d11e448d1545147b357a6c}{MPU6050\_GetFiFoData}}(buffer);}
\DoxyCodeLine{00481     \textcolor{comment}{//  printf("{}w: \%i\(\backslash\)r\(\backslash\)n"{}, buffer[0]);//+(buffer[1]<<8)+(buffer[2]<<16)+(buffer[3]<<24));}}
\DoxyCodeLine{00482     \textcolor{comment}{//  printf("{}Gx: \%i\(\backslash\)r\(\backslash\)n"{}, buffer[4]);//+(buffer[5]<<8)+(buffer[6]<<16)+(buffer[7]<<24));}}
\DoxyCodeLine{00483     \textcolor{comment}{//  printf("{}Gy: \%i\(\backslash\)r\(\backslash\)n"{}, buffer[8]);//+(buffer[9]<<8)+(buffer[10]<<16)+(buffer[12]<<24));}}
\DoxyCodeLine{00484     \textcolor{comment}{//  printf("{}Gz: \%i\(\backslash\)r\(\backslash\)n"{}, buffer[12]);//+(buffer[9]<<8)+(buffer[10]<<16)+(buffer[12]<<24));}}
\DoxyCodeLine{00485     \textcolor{comment}{//  printf("{}Ax: \%i\(\backslash\)r\(\backslash\)n"{}, buffer[4]);//+(buffer[5]<<8)+(buffer[6]<<16)+(buffer[7]<<24));}}
\DoxyCodeLine{00486     \textcolor{comment}{//  printf("{}Ay: \%i\(\backslash\)r\(\backslash\)n"{}, buffer[8]);//+(buffer[9]<<8)+(buffer[10]<<16)+(buffer[12]<<24));}}
\DoxyCodeLine{00487     \textcolor{comment}{//  printf("{}Az: \%i\(\backslash\)r\(\backslash\)n"{}, buffer[12]);//+(buffer[9]<<8)+(buffer[10]<<16)+(buffer[12]<<24));}}
\DoxyCodeLine{00488     printf(\textcolor{stringliteral}{"{}Gx: \%i ** Gy: \%i ** Gz: \%i\(\backslash\)r\(\backslash\)n"{}},buffer[4] ,buffer[8], buffer[12]);}
\DoxyCodeLine{00489     printf(\textcolor{stringliteral}{"{}Az: \%i ** Ay: \%i ** Az: \%i\(\backslash\)r\(\backslash\)n"{}}, buffer[4],buffer[8],buffer[12]);}
\DoxyCodeLine{00490 }
\DoxyCodeLine{00491 \}}

\end{DoxyCode}
\mbox{\Hypertarget{MPU6050__GY521_8c_a6298e3fba6912f640f4fdc1fa11fd982}\label{MPU6050__GY521_8c_a6298e3fba6912f640f4fdc1fa11fd982}} 
\index{MPU6050\_GY521.c@{MPU6050\_GY521.c}!MPU6050\_FIFO\_RESET@{MPU6050\_FIFO\_RESET}}
\index{MPU6050\_FIFO\_RESET@{MPU6050\_FIFO\_RESET}!MPU6050\_GY521.c@{MPU6050\_GY521.c}}
\doxysubsubsection{\texorpdfstring{MPU6050\_FIFO\_RESET()}{MPU6050\_FIFO\_RESET()}}
{\footnotesize\ttfamily void MPU6050\+\_\+\+FIFO\+\_\+\+RESET (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{MPU6050__GY521_8c_source_l00468}{468}} of file \mbox{\hyperlink{MPU6050__GY521_8c_source}{MPU6050\+\_\+\+GY521.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00468                          \{}
\DoxyCodeLine{00469     uint8\_t buffer;}
\DoxyCodeLine{00470     HAL\_I2C\_Mem\_Read(MPU6050\_hi2c,MPU6050\_ADDR, MPU6050\_USR\_CRTL\_REG, 1,\&buffer , 1,100);}
\DoxyCodeLine{00471     printf(\textcolor{stringliteral}{"{}\%i\(\backslash\)r\(\backslash\)n"{}}, buffer);}
\DoxyCodeLine{00472     buffer = MPU6050\_USR\_CRTL\_FIFO\_EN | MPU6050\_USR\_CRTL\_FIFO\_RESET;}
\DoxyCodeLine{00473 }
\DoxyCodeLine{00474     HAL\_I2C\_Mem\_Write(MPU6050\_hi2c,MPU6050\_ADDR, MPU6050\_USR\_CRTL\_REG, 1,\&buffer,1,100);}
\DoxyCodeLine{00475     HAL\_I2C\_Mem\_Read(MPU6050\_hi2c,MPU6050\_ADDR, MPU6050\_USR\_CRTL\_REG, 1,\&buffer , 1,100);}
\DoxyCodeLine{00476     printf(\textcolor{stringliteral}{"{}\%i\(\backslash\)r\(\backslash\)n"{}}, buffer);}
\DoxyCodeLine{00477 \}}

\end{DoxyCode}
\mbox{\Hypertarget{MPU6050__GY521_8c_a02824d958116be29bdab36becfb8c7f6}\label{MPU6050__GY521_8c_a02824d958116be29bdab36becfb8c7f6}} 
\index{MPU6050\_GY521.c@{MPU6050\_GY521.c}!MPU6050\_GetDMPIntReg@{MPU6050\_GetDMPIntReg}}
\index{MPU6050\_GetDMPIntReg@{MPU6050\_GetDMPIntReg}!MPU6050\_GY521.c@{MPU6050\_GY521.c}}
\doxysubsubsection{\texorpdfstring{MPU6050\_GetDMPIntReg()}{MPU6050\_GetDMPIntReg()}}
{\footnotesize\ttfamily uint8\+\_\+t MPU6050\+\_\+\+Get\+DMPInt\+Reg (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{MPU6050__GY521_8c_source_l00438}{438}} of file \mbox{\hyperlink{MPU6050__GY521_8c_source}{MPU6050\+\_\+\+GY521.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00438                                   \{}
\DoxyCodeLine{00439     uint8\_t retval = 0;}
\DoxyCodeLine{00440     HAL\_I2C\_Mem\_Read(MPU6050\_hi2c, MPU6050\_ADDR,MPU6050\_RA\_DMP\_INT\_STATUS ,  1, \&retval, 1,100);}
\DoxyCodeLine{00441     \textcolor{keywordflow}{return} retval;}
\DoxyCodeLine{00442 \}}

\end{DoxyCode}
\mbox{\Hypertarget{MPU6050__GY521_8c_a8885c86e21d11e448d1545147b357a6c}\label{MPU6050__GY521_8c_a8885c86e21d11e448d1545147b357a6c}} 
\index{MPU6050\_GY521.c@{MPU6050\_GY521.c}!MPU6050\_GetFiFoData@{MPU6050\_GetFiFoData}}
\index{MPU6050\_GetFiFoData@{MPU6050\_GetFiFoData}!MPU6050\_GY521.c@{MPU6050\_GY521.c}}
\doxysubsubsection{\texorpdfstring{MPU6050\_GetFiFoData()}{MPU6050\_GetFiFoData()}}
{\footnotesize\ttfamily void MPU6050\+\_\+\+Get\+Fi\+Fo\+Data (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{buffer\mbox{[}1024\mbox{]} }\end{DoxyParamCaption})}

Gets the Data out of the FIFO-\/\+Buffer, Data inside the FIFO depends on the FIFO\+\_\+\+EN Register set in the Init 

Definition at line \mbox{\hyperlink{MPU6050__GY521_8c_source_l00459}{459}} of file \mbox{\hyperlink{MPU6050__GY521_8c_source}{MPU6050\+\_\+\+GY521.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00459                                               \{}
\DoxyCodeLine{00460     \textcolor{keywordflow}{if} ((\mbox{\hyperlink{MPU6050__GY521_8c_aaee8c045744fa4931cc694f7ef43d034}{MPU6050\_GetIntReg}}() \& 0x01) == MPU6050\_INT\_DATA\_RDY)\{}
\DoxyCodeLine{00461         uint16\_t count =  MPU6050\_Read\_FIFOcount();}
\DoxyCodeLine{00462         \textcolor{comment}{// for (int fifo\_counter  = 0; fifo\_counter < count; fifo\_counter++)\{}}
\DoxyCodeLine{00463         HAL\_I2C\_Mem\_Read(MPU6050\_hi2c, MPU6050\_ADDR, MPU6050\_FIFO\_DATA\_REG, 1024, buffer, 1,100);}
\DoxyCodeLine{00464         \textcolor{comment}{// \}}}
\DoxyCodeLine{00465     \}}
\DoxyCodeLine{00466 \}}

\end{DoxyCode}
\mbox{\Hypertarget{MPU6050__GY521_8c_aaee8c045744fa4931cc694f7ef43d034}\label{MPU6050__GY521_8c_aaee8c045744fa4931cc694f7ef43d034}} 
\index{MPU6050\_GY521.c@{MPU6050\_GY521.c}!MPU6050\_GetIntReg@{MPU6050\_GetIntReg}}
\index{MPU6050\_GetIntReg@{MPU6050\_GetIntReg}!MPU6050\_GY521.c@{MPU6050\_GY521.c}}
\doxysubsubsection{\texorpdfstring{MPU6050\_GetIntReg()}{MPU6050\_GetIntReg()}}
{\footnotesize\ttfamily uint8\+\_\+t MPU6050\+\_\+\+Get\+Int\+Reg (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}

DMP functions 

Definition at line \mbox{\hyperlink{MPU6050__GY521_8c_source_l00433}{433}} of file \mbox{\hyperlink{MPU6050__GY521_8c_source}{MPU6050\+\_\+\+GY521.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00433                                \{}
\DoxyCodeLine{00434     uint8\_t retval = 0;}
\DoxyCodeLine{00435     HAL\_I2C\_Mem\_Read(MPU6050\_hi2c, MPU6050\_ADDR, MPU6050\_INT\_STATUS\_REG, 1, \&retval, 1,100);}
\DoxyCodeLine{00436     \textcolor{keywordflow}{return} retval;}
\DoxyCodeLine{00437 \}}

\end{DoxyCode}
\mbox{\Hypertarget{MPU6050__GY521_8c_a1a93e7a7a1d489ec9ce063a30d1a5df5}\label{MPU6050__GY521_8c_a1a93e7a7a1d489ec9ce063a30d1a5df5}} 
\index{MPU6050\_GY521.c@{MPU6050\_GY521.c}!MPU6050\_init@{MPU6050\_init}}
\index{MPU6050\_init@{MPU6050\_init}!MPU6050\_GY521.c@{MPU6050\_GY521.c}}
\doxysubsubsection{\texorpdfstring{MPU6050\_init()}{MPU6050\_init()}}
{\footnotesize\ttfamily \mbox{\hyperlink{MPU6050__GY521_8h_a93fe4b900e9a53cf29a99adc9e64d7c4}{MPU6050\+\_\+\+STATUS}} MPU6050\+\_\+init (\begin{DoxyParamCaption}\item[{I2\+C\+\_\+\+Handle\+Type\+Def $\ast$}]{\+\_\+\+\_\+hi2c,  }\item[{\mbox{\hyperlink{structMPU6050__Data}{MPU6050\+\_\+\+Data}} $\ast$}]{Sensor\+\_\+\+Data\+\_\+pointer,  }\item[{\mbox{\hyperlink{MPU6050__GY521_8h_a18ad019342a4d49779b497db4882529d}{MPU6050\+\_\+\+ACCL\+\_\+\+RES}}}]{accl\+\_\+resolution,  }\item[{\mbox{\hyperlink{MPU6050__GY521_8h_aca49957b1a43f91ee978555e2dfc7ff0}{MPU6050\+\_\+\+GYRO\+\_\+\+RES}}}]{gyro\+\_\+resolution,  }\item[{uint8\+\_\+t}]{samplerate }\end{DoxyParamCaption})}



Init for the MPU6050. 


\begin{DoxyParams}{Parameters}
{\em \+\_\+\+\_\+hi2c} & i2c handler \\
\hline
{\em Sensor\+\_\+\+Data\+\_\+pointer} & struct to save the data \\
\hline
{\em accl\+\_\+resolution} & \\
\hline
{\em gyro\+\_\+resolution} & \\
\hline
{\em samplerate} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
MPU6050\+\_\+\+STATUS 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{MPU6050__GY521_8c_source_l00025}{25}} of file \mbox{\hyperlink{MPU6050__GY521_8c_source}{MPU6050\+\_\+\+GY521.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00025                                                                                                                                                                                  \{}
\DoxyCodeLine{00026 }
\DoxyCodeLine{00027     uint8\_t Data=0x00;}
\DoxyCodeLine{00028     MPU6050\_hi2c = \_\_hi2c;}
\DoxyCodeLine{00029     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}} = Sensor\_Data\_pointer;}
\DoxyCodeLine{00030     printf(\textcolor{stringliteral}{"{}MPU6050 init begin\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00031     \textcolor{comment}{//Check if device is ready: Let LED blink 3 times if yes}}
\DoxyCodeLine{00032     \textcolor{keywordflow}{if}((HAL\_I2C\_IsDeviceReady(MPU6050\_hi2c, MPU6050\_ADDR, 2, 20)) != HAL\_OK)\{}
\DoxyCodeLine{00033         printf(\textcolor{stringliteral}{"{}MPU 6050 No Connection\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00034         \textcolor{keywordflow}{return} MPU6050\_Status\_Notconnected;}
\DoxyCodeLine{00035 }
\DoxyCodeLine{00036     \}}
\DoxyCodeLine{00037 }
\DoxyCodeLine{00038 }
\DoxyCodeLine{00039 }
\DoxyCodeLine{00040     \textcolor{comment}{//check WHO\_AM\_I: If answer is I\_AM toggle LED}}
\DoxyCodeLine{00041     HAL\_I2C\_Mem\_Read(MPU6050\_hi2c, MPU6050\_ADDR, MPU6050\_WHO\_AM\_I\_REG, 1, \&Data, 1, 1000);}
\DoxyCodeLine{00042 }
\DoxyCodeLine{00043     \textcolor{keywordflow}{if} ((Data =! \mbox{\hyperlink{MPU6050__GY521_8h_a1de390da371b9193740d43bf523b9791}{MPU6050\_I\_AM}})) \textcolor{comment}{// if-\/statement is 1 if MPU is present}}
\DoxyCodeLine{00044     \{}
\DoxyCodeLine{00045         \textcolor{keywordflow}{return} MPU6050\_Status\_Invalid;}
\DoxyCodeLine{00046     \}}
\DoxyCodeLine{00047 }
\DoxyCodeLine{00048 }
\DoxyCodeLine{00049 }
\DoxyCodeLine{00050     \textcolor{comment}{// wake sensor}}
\DoxyCodeLine{00051     Data=0x00;}
\DoxyCodeLine{00052     \textcolor{keywordflow}{if}(HAL\_I2C\_Mem\_Write(MPU6050\_hi2c, MPU6050\_ADDR, MPU6050\_PWR\_MGMT\_1\_REG, 1, \&Data, 1, 1000)!=HAL\_OK)}
\DoxyCodeLine{00053     \{}
\DoxyCodeLine{00054         \textcolor{keywordflow}{return} MPU6050\_Status\_Invalid;}
\DoxyCodeLine{00055     \}}
\DoxyCodeLine{00056 }
\DoxyCodeLine{00057 }
\DoxyCodeLine{00058     \textcolor{comment}{// Config range/resolution Gyroscope}}
\DoxyCodeLine{00059     Data = 0xE0 | (gyro\_resolution<<3);}
\DoxyCodeLine{00060     \textcolor{keywordflow}{if}(HAL\_I2C\_Mem\_Write(MPU6050\_hi2c, MPU6050\_ADDR, MPU6050\_GYRO\_CONFIG\_REG, 1, \&Data, 1, 1000) != HAL\_OK)\{}
\DoxyCodeLine{00061         \textcolor{keywordflow}{return} MPU6050\_Status\_Error;}
\DoxyCodeLine{00062     \}}
\DoxyCodeLine{00063     \textcolor{comment}{//for normalization of Gyroscope range}}
\DoxyCodeLine{00064     \textcolor{keywordflow}{switch} (gyro\_resolution)\{}
\DoxyCodeLine{00065     \textcolor{keywordflow}{case} MPU6050\_GYRO\_250deg:}
\DoxyCodeLine{00066         \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Gyro\_mult = \mbox{\hyperlink{MPU6050__GY521_8h_a0c37fc112539bcdbe9faa322935b02d7}{MPU6050\_GYRO\_SENS\_250}};}
\DoxyCodeLine{00067         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00068     \textcolor{keywordflow}{case} MPU6050\_GYRO\_500deg:}
\DoxyCodeLine{00069         \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Gyro\_mult = MPU6050\_GYRO\_SENS\_500;}
\DoxyCodeLine{00070         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00071     \textcolor{keywordflow}{case} MPU6050\_GYRO\_1000deg:}
\DoxyCodeLine{00072         \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Gyro\_mult = MPU6050\_GYRO\_SENS\_1000;}
\DoxyCodeLine{00073         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00074     \textcolor{keywordflow}{case} MPU6050\_GYRO\_2000deg:}
\DoxyCodeLine{00075         \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Gyro\_mult = MPU6050\_GYRO\_SENS\_2000;}
\DoxyCodeLine{00076         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00077     \}}
\DoxyCodeLine{00078 }
\DoxyCodeLine{00079 }
\DoxyCodeLine{00080     \textcolor{comment}{// Config range/resolution of Accelerometer}}
\DoxyCodeLine{00081     Data = 0xE0 | (accl\_resolution<<3);}
\DoxyCodeLine{00082     \textcolor{keywordflow}{if}(HAL\_I2C\_Mem\_Write(MPU6050\_hi2c, MPU6050\_ADDR, MPU6050\_ACCL\_CONFIG\_REG, 1, \&Data, 1, 1000) != HAL\_OK)\{}
\DoxyCodeLine{00083         \textcolor{keywordflow}{return} MPU6050\_Status\_Error;}
\DoxyCodeLine{00084     \}}
\DoxyCodeLine{00085 }
\DoxyCodeLine{00086     \textcolor{keywordflow}{switch}(accl\_resolution)\{}
\DoxyCodeLine{00087     \textcolor{keywordflow}{case} MPU6050\_ACCL\_2G:}
\DoxyCodeLine{00088         \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Accl\_mult = \mbox{\hyperlink{MPU6050__GY521_8h_a1c92b8af476c3704f73583d654dd3b5e}{MPU6050\_ACCL\_SENS\_2}};}
\DoxyCodeLine{00089         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00090     \textcolor{keywordflow}{case} \mbox{\hyperlink{MPU6050__GY521_8h_a18ad019342a4d49779b497db4882529da6390f128316eec4b36b7ea3b6d59f581}{MPU6050\_ACCL\_4G}}:}
\DoxyCodeLine{00091         \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Accl\_mult = MPU6050\_ACCL\_SENS\_4;}
\DoxyCodeLine{00092         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00093     \textcolor{keywordflow}{case} \mbox{\hyperlink{MPU6050__GY521_8h_a18ad019342a4d49779b497db4882529dadd5c313c6802fd5118fd0ceec67ab4a9}{MPU6050\_ACCL\_8G}}:}
\DoxyCodeLine{00094         \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Accl\_mult = MPU6050\_ACCL\_SENS\_8;}
\DoxyCodeLine{00095         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00096     \textcolor{keywordflow}{case} \mbox{\hyperlink{MPU6050__GY521_8h_a18ad019342a4d49779b497db4882529daa44ddb1fd0aa9d8783c29f2fbf45fda8}{MPU6050\_ACCL\_16G}}:}
\DoxyCodeLine{00097         \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Accl\_mult = MPU6050\_ACCL\_SENS\_16;}
\DoxyCodeLine{00098         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00099     \}}
\DoxyCodeLine{00100 }
\DoxyCodeLine{00101 }
\DoxyCodeLine{00102     \textcolor{comment}{// Config Sample Rate: Sample Rate=8/(1+Data)}}
\DoxyCodeLine{00103     Data=samplerate;}
\DoxyCodeLine{00104     \textcolor{keywordflow}{if}(HAL\_I2C\_Mem\_Write(MPU6050\_hi2c, MPU6050\_ADDR, \mbox{\hyperlink{MPU6050__GY521_8h_a8264ea96144f5fa98bd1a22ceb590315}{MPU6050\_SMPLRT\_DIV\_REG}}, 1, \&Data, 1, 1000) != HAL\_OK)\{}
\DoxyCodeLine{00105         \textcolor{keywordflow}{return} MPU6050\_Status\_Error;}
\DoxyCodeLine{00106     \}}
\DoxyCodeLine{00107 }
\DoxyCodeLine{00108     \textcolor{comment}{//Set Gyroscope offset to zero}}
\DoxyCodeLine{00109     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Gx\_offset = 0;}
\DoxyCodeLine{00110     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Gy\_offset = 0;}
\DoxyCodeLine{00111     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Gz\_offset = 0;}
\DoxyCodeLine{00112 }
\DoxyCodeLine{00113     \textcolor{comment}{//Set Accelerometer offset to zero}}
\DoxyCodeLine{00114     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Ax\_offset = 0;}
\DoxyCodeLine{00115     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Ay\_offset = 0;}
\DoxyCodeLine{00116     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Az\_offset = 0;}
\DoxyCodeLine{00117 }
\DoxyCodeLine{00118     \textcolor{comment}{//  //Set User Controll, Enable FIFO}}
\DoxyCodeLine{00119     Data = MPU6050\_USR\_CRTL\_FIFO\_EN;}
\DoxyCodeLine{00120     \textcolor{keywordflow}{if}(HAL\_I2C\_Mem\_Write(MPU6050\_hi2c, MPU6050\_ADDR, MPU6050\_USR\_CRTL\_REG, 1, \&Data, 1, 1000) != HAL\_OK)\{}
\DoxyCodeLine{00121         \textcolor{keywordflow}{return} MPU6050\_Status\_Error;}
\DoxyCodeLine{00122     \}}
\DoxyCodeLine{00123     HAL\_I2C\_Mem\_Read(MPU6050\_hi2c, MPU6050\_ADDR, MPU6050\_USR\_CRTL\_REG, 1, \&Data, 1, 1000);}
\DoxyCodeLine{00124     \textcolor{comment}{//  printf("{}MPU6050\_USR\_CRTL\_REG: \%i\(\backslash\)r\(\backslash\)n"{},Data);}}
\DoxyCodeLine{00125     \textcolor{comment}{// Interruppt Enable}}
\DoxyCodeLine{00126     Data = MPU6050\_INT\_EN\_DATA\_RDY;}
\DoxyCodeLine{00127     \textcolor{keywordflow}{if}(HAL\_I2C\_Mem\_Write(MPU6050\_hi2c, MPU6050\_ADDR,MPU6050\_RA\_INT\_ENABLE, 1, \&Data, 1, 1000) != HAL\_OK)\{}
\DoxyCodeLine{00128         \textcolor{keywordflow}{return} MPU6050\_Status\_Error;}
\DoxyCodeLine{00129     \}}
\DoxyCodeLine{00130 }
\DoxyCodeLine{00131 }
\DoxyCodeLine{00132     \textcolor{comment}{//determines which sensor measurements are loaded into the FIFO buffer}}
\DoxyCodeLine{00133     \textcolor{comment}{//  Data = MPU6050\_FIFO\_EN\_ACCEL | MPU6050\_FIFO\_EN\_ZG | MPU6050\_FIFO\_EN\_YG | MPU6050\_FIFO\_EN\_XG;}}
\DoxyCodeLine{00134     Data = 0x00;}
\DoxyCodeLine{00135     \textcolor{keywordflow}{if}(HAL\_I2C\_Mem\_Write(MPU6050\_hi2c, MPU6050\_ADDR, MPU6050\_FIFO\_DATA\_REG, 1, \&Data, 1, 1000) != HAL\_OK)\{}
\DoxyCodeLine{00136         \textcolor{keywordflow}{return} MPU6050\_Status\_Error;}
\DoxyCodeLine{00137     \}}
\DoxyCodeLine{00138     printf(\textcolor{stringliteral}{"{}MPU6050 init end\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00139     \textcolor{keywordflow}{return} MPU6050\_Status\_OK;}
\DoxyCodeLine{00140 \}}

\end{DoxyCode}
\mbox{\Hypertarget{MPU6050__GY521_8c_a54ed50404498f4682d81ad8cb74a7150}\label{MPU6050__GY521_8c_a54ed50404498f4682d81ad8cb74a7150}} 
\index{MPU6050\_GY521.c@{MPU6050\_GY521.c}!MPU6050\_Read\_Accl@{MPU6050\_Read\_Accl}}
\index{MPU6050\_Read\_Accl@{MPU6050\_Read\_Accl}!MPU6050\_GY521.c@{MPU6050\_GY521.c}}
\doxysubsubsection{\texorpdfstring{MPU6050\_Read\_Accl()}{MPU6050\_Read\_Accl()}}
{\footnotesize\ttfamily \mbox{\hyperlink{MPU6050__GY521_8h_a93fe4b900e9a53cf29a99adc9e64d7c4}{MPU6050\+\_\+\+STATUS}} MPU6050\+\_\+\+Read\+\_\+\+Accl (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



reeads only accl data 

\begin{DoxyReturn}{Returns}
MPU6050\+\_\+\+STATUS 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{MPU6050__GY521_8c_source_l00149}{149}} of file \mbox{\hyperlink{MPU6050__GY521_8c_source}{MPU6050\+\_\+\+GY521.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00149                                   \{}
\DoxyCodeLine{00150 }
\DoxyCodeLine{00151     uint8\_t Rec\_Data[6];}
\DoxyCodeLine{00152 }
\DoxyCodeLine{00153     \textcolor{comment}{// Read 6Bytes (2byte per axis) starting from ACCL\_XOUT\_H register}}
\DoxyCodeLine{00154     \textcolor{keywordflow}{if}(HAL\_I2C\_Mem\_Read (MPU6050\_hi2c, MPU6050\_ADDR, MPU6050\_ACCL\_XOUT\_H\_REG, 1, Rec\_Data, 6, 1000) != HAL\_OK)\{}
\DoxyCodeLine{00155         \textcolor{keywordflow}{return} MPU6050\_Status\_Error;}
\DoxyCodeLine{00156     \}}
\DoxyCodeLine{00157 }
\DoxyCodeLine{00158     \textcolor{comment}{// Data for all axis comes as 6Byte array, in the following it is filled into one 16-\/bit array for each axis}}
\DoxyCodeLine{00159     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Accl\_X = (int16\_t)(Rec\_Data[0]<<8 | Rec\_Data[1]) -\/ \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Ax\_offset;}
\DoxyCodeLine{00160     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Accl\_Y = (int16\_t)(Rec\_Data[2]<<8 | Rec\_Data[3]) -\/ \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Ay\_offset;}
\DoxyCodeLine{00161     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Accl\_Z = (int16\_t)(Rec\_Data[4]<<8 | Rec\_Data[5]) -\/ \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Az\_offset;}
\DoxyCodeLine{00162 }
\DoxyCodeLine{00163     \textcolor{keywordflow}{return} MPU6050\_Read\_OK;}
\DoxyCodeLine{00164 \}}

\end{DoxyCode}
\mbox{\Hypertarget{MPU6050__GY521_8c_ad201e8f55c11cb39a7077fe1d5b32f70}\label{MPU6050__GY521_8c_ad201e8f55c11cb39a7077fe1d5b32f70}} 
\index{MPU6050\_GY521.c@{MPU6050\_GY521.c}!MPU6050\_Read\_FIFOcount@{MPU6050\_Read\_FIFOcount}}
\index{MPU6050\_Read\_FIFOcount@{MPU6050\_Read\_FIFOcount}!MPU6050\_GY521.c@{MPU6050\_GY521.c}}
\doxysubsubsection{\texorpdfstring{MPU6050\_Read\_FIFOcount()}{MPU6050\_Read\_FIFOcount()}}
{\footnotesize\ttfamily uint16\+\_\+t MPU6050\+\_\+\+Read\+\_\+\+FIFOcount (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{MPU6050__GY521_8c_source_l00444}{444}} of file \mbox{\hyperlink{MPU6050__GY521_8c_source}{MPU6050\+\_\+\+GY521.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00444                                      \{}
\DoxyCodeLine{00445 }
\DoxyCodeLine{00446     uint8\_t retval[2];}
\DoxyCodeLine{00447     HAL\_I2C\_Mem\_Read (MPU6050\_hi2c, MPU6050\_ADDR, MPU6050\_FIFO\_COUNT\_H\_REG, 1, \&retval[1],1, 1000) ;}
\DoxyCodeLine{00448     HAL\_I2C\_Mem\_Read (MPU6050\_hi2c, MPU6050\_ADDR, MPU6050\_FIFO\_COUNT\_L\_REG, 1, \&retval[0],1, 1000) ;}
\DoxyCodeLine{00449     printf(\textcolor{stringliteral}{"{}\%i,\(\backslash\)r\(\backslash\)n"{}},retval[0]);}
\DoxyCodeLine{00450     printf(\textcolor{stringliteral}{"{}\%i,\(\backslash\)r\(\backslash\)n"{}},retval[1]);}
\DoxyCodeLine{00451     \textcolor{keywordflow}{return} (retval[0]<<8) + retval[1];}
\DoxyCodeLine{00452 }
\DoxyCodeLine{00453 }
\DoxyCodeLine{00454 \}}

\end{DoxyCode}
\mbox{\Hypertarget{MPU6050__GY521_8c_ac16021f5f2c6dbf509ed77ddfc6d943d}\label{MPU6050__GY521_8c_ac16021f5f2c6dbf509ed77ddfc6d943d}} 
\index{MPU6050\_GY521.c@{MPU6050\_GY521.c}!MPU6050\_Read\_Gyro@{MPU6050\_Read\_Gyro}}
\index{MPU6050\_Read\_Gyro@{MPU6050\_Read\_Gyro}!MPU6050\_GY521.c@{MPU6050\_GY521.c}}
\doxysubsubsection{\texorpdfstring{MPU6050\_Read\_Gyro()}{MPU6050\_Read\_Gyro()}}
{\footnotesize\ttfamily \mbox{\hyperlink{MPU6050__GY521_8h_a93fe4b900e9a53cf29a99adc9e64d7c4}{MPU6050\+\_\+\+STATUS}} MPU6050\+\_\+\+Read\+\_\+\+Gyro (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



reads only gyro data 

\begin{DoxyReturn}{Returns}
MPU6050\+\_\+\+STATUS 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{MPU6050__GY521_8c_source_l00171}{171}} of file \mbox{\hyperlink{MPU6050__GY521_8c_source}{MPU6050\+\_\+\+GY521.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00171                                   \{}
\DoxyCodeLine{00172 }
\DoxyCodeLine{00173     uint8\_t Rec\_Data[6];}
\DoxyCodeLine{00174 }
\DoxyCodeLine{00175     \textcolor{comment}{// Read 6Bytes (2byte per axis) starting from GYRO\_XOUT\_H register}}
\DoxyCodeLine{00176     \textcolor{keywordflow}{if}(HAL\_I2C\_Mem\_Read ( MPU6050\_hi2c, MPU6050\_ADDR, MPU6050\_GYRO\_XOUT\_H\_REG, 1, Rec\_Data, 6, 1000) != HAL\_OK)\{}
\DoxyCodeLine{00177         \textcolor{keywordflow}{return} MPU6050\_Status\_Error;}
\DoxyCodeLine{00178     \}}
\DoxyCodeLine{00179 }
\DoxyCodeLine{00180     \textcolor{comment}{// Get time of new Measurement and safe time of last measurement}}
\DoxyCodeLine{00181     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Gyro\_time   =   DWT-\/>CYCCNT;}
\DoxyCodeLine{00182     DWT-\/>CYCCNT             =   0;}
\DoxyCodeLine{00183 }
\DoxyCodeLine{00184     \textcolor{comment}{// Data for all axis comes as 6Byte array, in the following it is filled into one 16-\/bit array for each axis}}
\DoxyCodeLine{00185     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Gyro\_X = (int16\_t)(Rec\_Data[0]<<8 | Rec\_Data[1])-\/\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Gx\_offset;}
\DoxyCodeLine{00186     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Gyro\_Y = (int16\_t)(Rec\_Data[2]<<8 | Rec\_Data[3])-\/\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Gy\_offset;}
\DoxyCodeLine{00187     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Gyro\_Z = (int16\_t)(Rec\_Data[4]<<8 | Rec\_Data[5])-\/\mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Gz\_offset;}
\DoxyCodeLine{00188 }
\DoxyCodeLine{00189 }
\DoxyCodeLine{00190     \textcolor{keywordflow}{return} MPU6050\_Read\_OK;}
\DoxyCodeLine{00191 \}}

\end{DoxyCode}
\mbox{\Hypertarget{MPU6050__GY521_8c_a109418b6b13fd4ddff993014f625994f}\label{MPU6050__GY521_8c_a109418b6b13fd4ddff993014f625994f}} 
\index{MPU6050\_GY521.c@{MPU6050\_GY521.c}!MPU6050\_Read\_Sensor@{MPU6050\_Read\_Sensor}}
\index{MPU6050\_Read\_Sensor@{MPU6050\_Read\_Sensor}!MPU6050\_GY521.c@{MPU6050\_GY521.c}}
\doxysubsubsection{\texorpdfstring{MPU6050\_Read\_Sensor()}{MPU6050\_Read\_Sensor()}}
{\footnotesize\ttfamily \mbox{\hyperlink{MPU6050__GY521_8h_a93fe4b900e9a53cf29a99adc9e64d7c4}{MPU6050\+\_\+\+STATUS}} MPU6050\+\_\+\+Read\+\_\+\+Sensor (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Reads raw data from accl and gyro ~\newline
 

\begin{DoxyReturn}{Returns}
MPU6050\+\_\+\+STATUS 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{MPU6050__GY521_8c_source_l00198}{198}} of file \mbox{\hyperlink{MPU6050__GY521_8c_source}{MPU6050\+\_\+\+GY521.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00198                                     \{}
\DoxyCodeLine{00199 }
\DoxyCodeLine{00200     uint8\_t Rec\_Data[14];}
\DoxyCodeLine{00201 }
\DoxyCodeLine{00202     \textcolor{comment}{// Read 6Bytes (2byte per axis) starting from ACCL\_XOUT\_H register}}
\DoxyCodeLine{00203     \textcolor{keywordflow}{if} (HAL\_I2C\_Mem\_Read (MPU6050\_hi2c, MPU6050\_ADDR, MPU6050\_ACCL\_XOUT\_H\_REG, 1, Rec\_Data, 14, 1000) != HAL\_OK )\{}
\DoxyCodeLine{00204         \textcolor{keywordflow}{return} MPU6050\_Status\_Error;}
\DoxyCodeLine{00205         printf(\textcolor{stringliteral}{"{}READ ERROR\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00206     \}}
\DoxyCodeLine{00207     \textcolor{comment}{// Get time of new Measurement and safe time of last measurement}}
\DoxyCodeLine{00208     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Gyro\_time   =   DWT-\/>CYCCNT;}
\DoxyCodeLine{00209     DWT-\/>CYCCNT             =   0;}
\DoxyCodeLine{00210     \textcolor{comment}{// Data for all axis comes as 6Byte array, in the following it is filled into one 16-\/bit array for each axis}}
\DoxyCodeLine{00211     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Accl\_X = (int16\_t)(Rec\_Data[0]<<8 | Rec\_Data[1]) -\/ \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Ax\_offset;}
\DoxyCodeLine{00212     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Accl\_Y = (int16\_t)(Rec\_Data[2]<<8 | Rec\_Data[3]) -\/ \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Ay\_offset;}
\DoxyCodeLine{00213     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Accl\_Z = (int16\_t)(Rec\_Data[4]<<8 | Rec\_Data[5]) -\/ \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Az\_offset;}
\DoxyCodeLine{00214     \textcolor{comment}{// Data for all axis comes as 6Byte array, in the following it is filled into one 16-\/bit array for each axis}}
\DoxyCodeLine{00215     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Gyro\_X = (int16\_t)(Rec\_Data[8]<<8 | Rec\_Data[9]) -\/ \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Gx\_offset;}
\DoxyCodeLine{00216     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Gyro\_Y = (int16\_t)(Rec\_Data[10]<<8 | Rec\_Data[11]) -\/ \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Gy\_offset;}
\DoxyCodeLine{00217     \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Gyro\_Z = (int16\_t)(Rec\_Data[12]<<8 | Rec\_Data[13]) -\/ \mbox{\hyperlink{MPU6050__GY521_8h_abdc15688e79d6395670b10cf1b2e1235}{Sensor\_Data}}-\/>Gz\_offset;}
\DoxyCodeLine{00218 }
\DoxyCodeLine{00219     \textcolor{keywordflow}{return} MPU6050\_Read\_OK;}
\DoxyCodeLine{00220 \}}

\end{DoxyCode}
